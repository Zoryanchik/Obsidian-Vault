![[Pasted image 20251103195503.png]]![[Pasted image 20251103195102.png]]![[Pasted image 20251103195113.png]]## ğŸ§© **Question 24**

**Question:**  
When inspecting the **Type field** within the ICMP headers of the _response packets_, what are the two types of ICMP messages? _(Select two)_

### âœ… **Correct Answers:**

**a. 3 (Destination Unreachable)**  
**c. 11 (Time-to-live exceeded)**

### ğŸ’¡ **Explanation:**

- **Traceroute** sends UDP packets with increasing **TTL** values.
    
- As packets move through the network:
    
    - Each intermediate router whose **TTL expires** sends back an **ICMP Type 11 (Time-to-Live Exceeded)** message.
        
    - When the packet **finally reaches the destination host** (but to a high-number UDP port that isnâ€™t open), the destination sends back **ICMP Type 3 (Destination Unreachable)** with **Code 3 (Port Unreachable)**.
        
- These two ICMP message types allow traceroute to identify routers along the path and the final destination.
    

---

## ğŸ§  **Question 25**

**Question:**  
When inspecting the contents of the ICMP headers in the _response packets_, which two protocol headers do you see embedded inside?

### âœ… **Correct Answers:**

**d. UDP**  
**e. IP**

### ğŸ’¡ **Explanation:**

- ICMP error messages include a portion of the **original packet that caused the error**.
    
- Specifically, each ICMP error response (like Type 11 or Type 3) includes:
    
    - The **IP header** of the original packet, and
        
    - The **first 8 bytes** of the **transport layer header** (in this case, UDP).
        
- These embedded headers allow the sender (traceroute) to identify **which packet triggered** the ICMP message.
    

---

## âš™ï¸ **Question 26**

**Question:**  
How does the traceroute sender match each UDP request with its corresponding ICMP response to compute RTT?

### âœ… **Correct Answer:**

**a. By matching certain UDP packet fields (source and destination ports) of the request with the UDP header contained within ICMP header of the responses**

### ğŸ’¡ **Explanation:**

- Each UDP probe has a unique combination of **source and destination ports**.
    
- When an ICMP error message is returned, it includes the original UDP header, allowing traceroute to **match** the reply to the original request using these port numbers.
    
- TTL matching (option c) is **not reliable**, and matching in order (option d) isnâ€™t always accurate in real networks.
    

---

## ğŸŒ **Question 27**

**Question:**  
Which of the following are correct about the packets sent from the traceroute application?

### âœ… **Correct Answers:**

**a. All requests have the same Source Address in their IP headers.**  
**d. Starting with the second request, each request uses a destination port that is incremented by one compared to the previous request.**  
**e. All requests have the same Destination Address in their IP headers.**

### ğŸ’¡ **Explanation:**

- All traceroute probes come from the **same source IP** (the host running traceroute). âœ…
    
- They are all destined to the **same target IP address**, but with **different TTL values**. âœ…
    
- Each probe uses a **different destination port** (incremented each time) to uniquely identify the probe. âœ…
    
- The **TTL value changes** with each request (starting from 1 and increasing), so option (c) is âŒ.
    
- The **source and destination ports** are **not constant** (so option b is âŒ).